top_srcdir     = @top_srcdir@
srcdir         = @srcdir@
VPATH          = @srcdir@ 

SQCLEVEL = 2
DEVSQCLEVEL = 4

ESLDIR = @INFERNAL_ESLDIR@

# beautification magic stolen from git 
#
QUIET_SUBDIR0 = +${MAKE} -C #space separator after -c
QUIET_SUBDIR1 = 
ifndef V
	QUIET_CC      = @echo '    ' CC $@;
	QUIET_GEN     = @echo '    ' GEN $@;
	QUIET_AR      = @echo '    ' AR $@;
	QUIET_SUBDIR0 = +@subdir=
	QUIET_SUBDIR1 = ; echo '    ' SUBDIR  $$subdir; \
		        ${MAKE} -C $$subdir
endif

.PHONY: check clean distclean

check: 
	@echo 
	@echo Running Infernal test suite...
	@echo
	@${srcdir}/../${ESLDIR}/devkit/sqc ${SQCLEVEL} ${srcdir}/exercises.sqc .. ${srcdir}/..

devcheck: 
	@echo 
	@echo Running Infernal developer test suite...
	@echo
#	@${srcdir}/../${ESLDIR}/devkit/sqc ${DEVSQCLEVEL} ${srcdir}/exercises.sqc   .. ${srcdir}/..
#	@${srcdir}/../${ESLDIR}/devkit/sqc ${DEVSQCLEVEL} ${srcdir}/cmalign.sqc     .. ${srcdir}/..
#	@${srcdir}/../${ESLDIR}/devkit/sqc ${DEVSQCLEVEL} ${srcdir}/cmbuild.sqc     .. ${srcdir}/..
#	@${srcdir}/../${ESLDIR}/devkit/sqc ${DEVSQCLEVEL} ${srcdir}/cmcalibrate.sqc .. ${srcdir}/..
#	@${srcdir}/../${ESLDIR}/devkit/sqc ${DEVSQCLEVEL} ${srcdir}/cmconvert.sqc   .. ${srcdir}/..
#	@${srcdir}/../${ESLDIR}/devkit/sqc ${DEVSQCLEVEL} ${srcdir}/cmemit.sqc      .. ${srcdir}/..
#	@${srcdir}/../${ESLDIR}/devkit/sqc ${DEVSQCLEVEL} ${srcdir}/cmfetch.sqc     .. ${srcdir}/..
	@${srcdir}/../${ESLDIR}/devkit/sqc ${DEVSQCLEVEL} ${srcdir}/cmsearch.sqc    .. ${srcdir}/..
#	@${srcdir}/../${ESLDIR}/devkit/sqc ${DEVSQCLEVEL} ${srcdir}/cmstat.sqc      .. ${srcdir}/..
# no cmpress.sqc, it's too simple; exercises.sqc covers all use cases

clean:
	-rm -f *.gcno *.gcda *.gcov
	-rm -f *.o *~ 

distclean: clean
	-rm -f Makefile

################################################################
# @LICENSE@
################################################################
